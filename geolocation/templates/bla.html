<html>
    <head>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    </head>
    <body>
        <button id = "find-me" onclick=geoFindMe type="submit">Show my location</button><br/>
        <p id = "status"></p>
        <script>
            function post_req(data){
                var allCookies = document.cookie;
                var csrf = allCookies.substring(10);
                var postdata = {
                    data: JSON.stringify(data),
                    'csrfmiddlewaretoken': csrf
                };
                $.post('', postdata);
            }   
            function geoFindMe() {
                const status = document.querySelector('#status');
                function success(position) {
                const latitude  = position.coords.latitude;
                const longitude = position.coords.longitude;
                data = {
                                lat: latitude,
                                long: longitude,
                                }
                
                post_req(data);              
                status.textContent = 'lat : ' +latitude+', long : ' + longitude ;
                
                }

                function error() {
                status.textContent = 'Unable to retrieve your location';
                    
                }

                if(!navigator.geolocation) {
                status.textContent = 'Geolocation is not supported by your browser';
                } else {
                status.textContent = 'Locatingâ€¦';
                navigator.geolocation.getCurrentPosition(success, error);
                }
        
            }


            document.querySelector('#find-me').addEventListener('click', geoFindMe);
            
        </script>
    </body>
</html>