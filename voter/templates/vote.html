{% extends "base_copy.html" %}
{% block designation %}
    {{post}}
{% endblock designation %}

{% block designation_info %}
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
{% endblock designation_info %}

{% block next_text %}
<li class="next-text"> HAB</li>
{% endblock next_text %}

{% block save_and_next %}
  <li class="content_button">
    <button type="submit" onclick="call_post_req()" class="buton waves-effect waves-light" onclick="" type="button"><a href="#"><span id="button_text">Save and Next</span></a></button>
  </li>
{% endblock save_and_next %} 
{% block content %}        
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>  
   <div class="row bottom-info" style="margin-top: 305px; margin-bottom:0;">
    {% for i in contestantList %}
      <div class="center col  s3 ">
        <img src="https://www.dropbox.com/s/5s93r0zh4jnuxx6/random_img.png?raw=1">
        <h5>{{i.name}}</h5>
        <h4>Final Year Masters in Computer Science</h4>
        <h5>Agenda</h5>
        <ul class="browser-default">
          <li style="font-size: 1.3em;">{{i.agenda1}}</li>
          <li style="font-size: 1.3em;">{{i.agenda2}}</li>
          <li style="font-size: 1.3em;">{{i.agenda3}}</li>
          <li style="font-size: 1.3em;">{{i.agenda4}}</li>
        </ul>
        <hr>
        <div class="vote-box">
          <div class='vote-button' data-default-text="Vote"
          data-alt-text="Voted"><button class="ripple waves-effect" onclick="voteClick(this.value)" value="{{i.pk}}" name="choice"></button></div>
        </div>
      </div>
        {% if forloop.counter|divisibleby:4 and not 0 %}
            </div>
            <div class="row bottom-info">
        {% endif %}
    {% endfor %}
        <div class="center col s3">
          <img src="https://www.dropbox.com/s/5s93r0zh4jnuxx6/random_img.png?raw=1">
          <h5>NOTA</h5>
          <hr>
          <div class="vote-box">
            <div class='vote-button'><button class="ripple waves-effect" onclick="voteClick(this.value)" value="{{post}}" name="choice"></button></div>
          </div>
        </div>
    </div>
    
  </div>
  <script>
    var vote_chosen=null;
    function voteClick(the_chosen_one) {
      vote_chosen = the_chosen_one;
      console.log(vote_chosen)
    }

    // async function call_post_req(){
    //   await post_req(vote_chosen);
    //   window.location.replace('http://localhost:8000/voter/vote/');
    // }
    const call_post_req = async()=>{
      console.log(vote_chosen)
      let d = await post_req(vote_chosen);
      window.location.replace('http://localhost:8000/voter/vote/');
    }

    function post_req(data) {
        var allCookies = document.cookie;
        var csrf = allCookies.substring(10);
        var postdata = {
            choice: data,
            'csrfmiddlewaretoken': csrf
        };
        $.post('/voter/vote/', postdata);
    }
  </script>
{% endblock content %}

